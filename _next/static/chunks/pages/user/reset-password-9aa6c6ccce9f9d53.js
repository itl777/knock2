(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[117],{72416:function(e,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user/reset-password",function(){return r(28202)}])},48043:function(e,s,r){"use strict";r.d(s,{Z:function(){return d}});var n=r(85893),t=r(61990),i=r.n(t),o=r(74931),a=r(67294);function d(e){let s,{name:r="",type:t="",value:d="",placeholder:l="",disabled:c=!1,inputStyles:u="def",onChange:_=()=>{},onBlur:p=()=>{}}=e,[m,x]=(0,a.useState)(!1),[f,h]=(0,a.useState)("");return null===d&&(d=""),"def"===u&&(s=!1===c?i().inputDefault:i().inputDisabled),"line"===u&&(s=!1===c?i().inputDefaultLine:i().inputDisabledLine),(0,a.useEffect)(()=>{h(t)},[]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:i().input,children:[(0,n.jsx)("input",{name:r,type:f,value:d,placeholder:l,disabled:!0===c?"disabled":"",className:s,onChange:_,onBlur:p}),(0,n.jsx)("button",{type:"button",className:i().eyeIcon,onClick:()=>{let e=!m;h(e?"text":"password"),x(e)},children:"def"===u&&"password"===t&&!1===c?m?(0,n.jsx)(o.y7o,{}):(0,n.jsx)(o.HR2,{}):null})]})})}},22535:function(e,s,r){"use strict";r.d(s,{Z:function(){return c}});var n=r(85893),t=r(11163),i=r(41664),o=r.n(i),a=r(98216),d=r.n(a),l=r(78773);function c(){let e=(0,t.useRouter)(),s=s=>s.some(s=>e.pathname.startsWith(s));return(0,n.jsx)("ul",{className:d().userTab,children:[{key:"profile",name:"會員資料",link:"/user/profile",paths:["/user/profile","/user/reset-password"]},{key:"reservation",name:"行程預約",link:"/user/reservation/ongoing",paths:["/user/reservation"]},{key:"orders",name:"商品訂單",link:"/user/orders/ongoing",paths:["/user/orders"]},{key:"favorite",name:"我的收藏",link:"/user/favorite",paths:["/user/favorite"]},{key:"coupons",name:"優惠券",link:"/user/coupon/ongoing",paths:["/user/coupon"]}].map((e,r)=>(0,n.jsx)("li",{className:s(e.paths)?d().active:"",children:(0,n.jsxs)(o(),{href:e.link,children:[(0,n.jsx)(l.ycZ,{}),(0,n.jsx)("span",{children:e.name})]})},e.key))})}},96345:function(e,s,r){"use strict";r.d(s,{Z:function(){return o}});var n=r(85893);r(67294);var t=r(5024),i=r.n(t);function o(e){let{userTab:s,userTabSec:r,sectionRight:t}=e;return(0,n.jsx)("section",{className:i().sectionContainer,children:(0,n.jsxs)("div",{className:i().sectionBody,children:[s,(0,n.jsxs)("div",{className:i().sectionRight,children:[r,t]})]})})}},29206:function(e,s,r){"use strict";r.d(s,{Z:function(){return a}});var n=r(85893),t=r(71937),i=r.n(t),o=r(61435);function a(e){let{text:s="目前無收藏",btnText:r="前往商城",href:t="/product",hideBtn:a=!1}=e;return(0,n.jsxs)("div",{className:i().ghostContainer,children:[(0,n.jsx)("h6",{children:s}),(0,n.jsx)("img",{src:"/ghost/ghost_06.png",alt:"",className:i().ghostImg}),!a&&(0,n.jsx)(o.Z,{btnText:r,href:t,paddingType:"medium"})]})}},56534:function(e,s,r){"use strict";r.d(s,{Z:function(){return l}});var n=r(85893),t=r(7630),i=r.n(t),o=r(48043),a=r(35514),d=r(45732);function l(e){let{label:s="",required:r=!1,name:t="",type:l="",value:c="",placeholder:u="",disabled:_=!1,btn:p=!1,btnText:m="",errorText:x="",onChange:f=()=>{},btnOnClick:h=()=>{}}=e;return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:i().formItem,children:[(0,n.jsx)("label",{htmlFor:t,className:i().myLabel,children:(0,n.jsx)(d.Z,{badgeContent:r?"*":0,color:"error",variant:"dot",children:s})}),(0,n.jsxs)("div",{className:i().myDiv,children:[(0,n.jsxs)("div",{className:i().row,children:[(0,n.jsx)(o.Z,{name:t,type:l,value:c,placeholder:u,disabled:_,onChange:f}),p?(0,n.jsx)("div",{className:i().button,children:(0,n.jsx)(a.Z,{onClick:h,btnText:m})}):null]}),(0,n.jsx)("div",{className:i().errorText,children:""!==x?(0,n.jsx)("span",{children:x}):""})]})]})})}},78519:function(e,s,r){"use strict";r.d(s,{Z:function(){return c}});var n=r(85893),t=r(1822),i=r.n(t),o=r(84295),a=r(33367),d=r(11163),l=r(34815);function c(e){let{text:s="",href:r,quickInput:t=""}=e,c=(0,d.useRouter)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"jsx-f8c0c1a5f1e34c31 title",children:[r?(0,n.jsx)(a.Z,{onClick:()=>{r&&c.push(r)},children:(0,n.jsx)(o.Wuc,{})}):null,(0,n.jsx)("h5",{className:"jsx-f8c0c1a5f1e34c31",children:s}),""===t?null:(0,n.jsx)(l.Z,{btnText:(0,n.jsx)("span",{style:{color:"#FFF"},className:"jsx-f8c0c1a5f1e34c31",children:"快速輸入"}),onClick:t})]}),(0,n.jsx)(i(),{id:"f8c0c1a5f1e34c31",children:".title.jsx-f8c0c1a5f1e34c31{width:100%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-moz-box-orient:horizontal;-moz-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:1rem;padding-bottom:10px;margin-bottom:20px;border-bottom:1px solid#d9d9d9;svg {\r\n            fill: #b99755;\r\n            font-size: 1.25rem;\r\n          }\r\n        }"})]})}},28202:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return Z}});var n=r(85893),t=r(67294),i=r(11163),o=r(45747),a=r(53483),d=r(96345),l=r(16075),c=r(62325),u=r(97928),_=r(1333),p=r.n(_),m=r(1604);let x=m.z.object({old_password:m.z.string({required_error:"請填寫密碼"}).min(8,{message:"請填寫舊密碼，至少為 8 個字元"}).max(100,{message:"密碼長度最多為 100 個字元"}),new_password:m.z.string({required_error:"請填寫密碼"}).min(8,{message:"請填寫新密碼，至少為 8 個字元"}).max(100,{message:"密碼長度最多為 100 個字元"}),reenter_new_password:m.z.string({required_error:"請再次填寫新密碼"}).min(8,{message:"請再次填寫新密碼"})}).refine(e=>e.old_password!==e.new_password,{message:"新密碼不能與舊密碼相同",path:["new_password"]}).refine(e=>e.new_password===e.reenter_new_password,{message:"兩次輸入的密碼不一致",path:["reenter_new_password"]}),f=m.z.object({new_password:m.z.string({required_error:"請填寫密碼"}).min(8,{message:"請填寫舊密碼，至少為 8 個字元"}).max(100,{message:"密碼長度最多為 100 個字元"}),reenter_new_password:m.z.string({required_error:"請再次填寫密碼"}).min(8,{message:"請再次填寫密碼"})}).refine(e=>e.new_password===e.reenter_new_password,{message:"兩次輸入的密碼不一致",path:["reenter_new_password"]});var h=r(78519),w=r(56534),b=r(61435);function g(e){let{user_id:s}=e,r=(0,i.useRouter)(),{auth:a,getAuthHeader:d}=(0,l.aC)(),{openSnackbar:_}=(0,u.Ds)(),{loginFormSwitch:m}=(0,c.NK)(),[g,j]=(0,t.useState)({old_password:"",new_password:"",reenter_new_password:""}),[y,v]=(0,t.useState)({old_password:"",new_password:"",reenter_new_password:""}),k=e=>{let{name:s,value:r}=e.target;j({...g,[s]:r})},N=async e=>{e.preventDefault();let n={...g},t={old_password:"",new_password:"",reenter_new_password:""},i={};if(0===a.id?(delete n.old_password,delete t.old_password,n.user_id=s,i=f.safeParse(n)):(n.user_id=a.id,i=x.safeParse(n)),!i.success){var l,c;if(null===(c=i.error)||void 0===c?void 0:null===(l=c.issues)||void 0===l?void 0:l.length){for(let e of i.error.issues)t[e.path[0]]=e.message;v(t)}return}let u=!!a.id;delete n.reenter_new_password;let p={method:"PUT",body:JSON.stringify({isLogin:u,data:n}),headers:{...d(),"Content-type":"application/json"}};try{let e=await fetch(o.mZ,p),s=await (null==e?void 0:e.json());s.success?(_("修改成功","success"),0===a.id?(r.push("/"),m("Login")):r.push("/user/profile")):(console.error(s.error),_(s.error,"error"))}catch(e){console.error(e),_("修改失敗","error")}};return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("form",{className:p()["reset-password-form"],onSubmit:N,children:[(0,n.jsx)("div",{className:p().box2,children:(0,n.jsxs)("div",{children:[(0,n.jsx)(h.Z,{text:"修改密碼",href:a.id?"/user/profile":null,quickInput:()=>j({new_password:"asdasdasd",reenter_new_password:"asdasdasd"})}),a.id?(0,n.jsx)(w.Z,{label:"舊密碼",name:"old_password",type:"password",value:g.old_password,placeholder:"請輸入舊密碼",disabled:!1,errorText:y.old_password,onChange:k}):"",(0,n.jsx)(w.Z,{label:"新密碼",name:"new_password",type:"password",value:g.new_password,placeholder:"請輸入新密碼",disabled:!1,errorText:y.new_password,onChange:k}),(0,n.jsx)(w.Z,{label:"確認密碼",name:"reenter_new_password",type:"password",value:g.reenter_new_password,placeholder:"請再次輸入新密碼",errorText:y.reenter_new_password,onChange:k})]})}),(0,n.jsx)("div",{className:p().box2,children:(0,n.jsx)(b.Z,{btnText:"送出",type:"submit",href:null,onClick:null,paddingType:"medium"})})]})})}var j=r(22535),y=r(29206),v=r(71219),k=r.n(v);function N(){let{loginFormSwitch:e}=(0,c.NK)();return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("section",{className:k().card,children:[(0,n.jsx)("div",{className:k().box,children:(0,n.jsx)(y.Z,{text:"驗證連結無效或已經過期，請再重新申請忘記密碼。",hideBtn:!0})}),(0,n.jsx)("div",{className:k().box,children:(0,n.jsx)(b.Z,{btnText:"重新申請",href:null,paddingType:"medium",onClick:()=>e("ForgotPassword")})})]})})}function Z(){let e=(0,i.useRouter)(),[s,r]=(0,t.useState)(!1),{auth:c}=(0,l.aC)(),[u,_]=(0,t.useState)(0);return(0,t.useEffect)(()=>{e.isReady&&!c.id&&e.query.t&&fetch(o.kw,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e.query.t})}).then(e=>e.json()).then(e=>{e.success?(_(e.user_id),r(!0)):(r(!1),console.error(e.error))})},[e.isReady,s,c.id]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(a.Z,{title:"重設密碼",pageName:"user",background:"light",children:(0,n.jsx)(d.Z,{userTab:c.id?(0,n.jsx)(j.Z,{}):"",sectionRight:s||c.id?(0,n.jsx)(g,{user_id:u}):(0,n.jsx)(N,{})})})})}},61990:function(e){e.exports={inputDefault:"input01_inputDefault__rC9_w",inputDefaultLine:"input01_inputDefaultLine__A5JCq",inputDisabled:"input01_inputDisabled__lYkq_",inputDisabledLine:"input01_inputDisabledLine__4myS3",input:"input01_input__IyFIT",eyeIcon:"input01_eyeIcon__MsDLy"}},1333:function(e){e.exports={"reset-password-form":"reset-password-form_reset-password-form__kQqyX",box2:"reset-password-form_box2__28cZJ"}},71219:function(e){e.exports={card:"token-expired_card__lwVtr",box:"token-expired_box__U2Ug0"}},7630:function(e){e.exports={formItem:"item_formItem__oTjum",myLabel:"item_myLabel__DgbHY",myDiv:"item_myDiv__B_jus",birthday:"item_birthday__r8QAL",row:"item_row__1KY1G",selectBtn:"item_selectBtn___63Nl",errorText:"item_errorText__lzi0n",button:"item_button__AofiW"}},98216:function(e){e.exports={userTab:"user-tab_userTab__oitHd",active:"user-tab_active__WQZR9"}},5024:function(e){e.exports={sectionContainer:"user-layout_sectionContainer__ZrxdZ",sectionBody:"user-layout_sectionBody__cHqmz",sectionRight:"user-layout_sectionRight__pqtpQ"}},71937:function(e){e.exports={right:"favorite-tab_right__xDrk9",ghostContainer:"favorite-tab_ghostContainer___37M1",ghostImg:"favorite-tab_ghostImg__KA8Rt"}}},function(e){e.O(0,[5970,4838,9317,4396,6660,509,2961,4321,959,6497,3483,2888,9774,179],function(){return e(e.s=72416)}),_N_E=e.O()}]);