(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8649],{89861:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user/orders/[status]",function(){return r(22326)}])},41051:function(e,t){"use strict";t.Z={src:"/_next/static/media/arrow-left.6b25a3fa.svg",height:22,width:47,blurWidth:0,blurHeight:0}},41032:function(e,t){"use strict";t.Z={src:"/_next/static/media/arrow-right.5eacb57b.svg",height:22,width:47,blurWidth:0,blurHeight:0}},48043:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(85893),s=r(61990),a=r.n(s),o=r(74931),i=r(67294);function c(e){let t,{name:r="",type:s="",value:c="",placeholder:d="",disabled:u=!1,inputStyles:l="def",onChange:_=()=>{},onBlur:h=()=>{}}=e,[p,x]=(0,i.useState)(!1),[f,m]=(0,i.useState)("");return null===c&&(c=""),"def"===l&&(t=!1===u?a().inputDefault:a().inputDisabled),"line"===l&&(t=!1===u?a().inputDefaultLine:a().inputDisabledLine),(0,i.useEffect)(()=>{m(s)},[]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:a().input,children:[(0,n.jsx)("input",{name:r,type:f,value:c,placeholder:d,disabled:!0===u?"disabled":"",className:t,onChange:_,onBlur:h}),(0,n.jsx)("button",{type:"button",className:a().eyeIcon,onClick:()=>{let e=!p;m(e?"text":"password"),x(e)},children:"def"===l&&"password"===s&&!1===u?p?(0,n.jsx)(o.y7o,{}):(0,n.jsx)(o.HR2,{}):null})]})})}},36452:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var n=r(85893),s=r(94525),a=r.n(s),o=r(67294),i=r(11163),c=r(16075),d=r(62325),u=r(61435);function l(e){let{text:t="請先登入",btnText:r="登入",href:s=null,hideBtn:l=!1}=e,_=(0,i.useRouter)(),{auth:h,authIsReady:p}=(0,c.aC)(),{loginFormSwitch:x}=(0,d.NK)();return(0,o.useEffect)(()=>{_.isReady&&p&&!h.id&&x("Login")},[h.id,_.isReady,p]),(0,n.jsxs)("div",{className:a().container,children:[(0,n.jsx)("h6",{children:t}),(0,n.jsx)("img",{src:"/ghost/ghost_06.png",alt:"",className:a().ghostImg}),!l&&(0,n.jsx)(u.Z,{btnText:r,href:s,paddingType:"medium",onClick:()=>{x("Login")}})]})}},59002:function(e,t,r){"use strict";r.d(t,{Z:function(){return _}});var n=r(85893),s=r(73223),a=r(79856),o=r(25675),i=r.n(o),c=r(747),d=r(28829),u=r(41051),l=r(41032);function _(e){let{page:t,totalPages:r,onPageChange:o}=e,_=()=>(0,n.jsx)(i(),{src:u.Z,alt:"Previous",width:47,height:21}),h=()=>(0,n.jsx)(i(),{src:l.Z,alt:"Next",width:47,height:21});return(0,n.jsx)(c.Z,{theme:d.Z,children:(0,n.jsx)("div",{className:"col-12 d-flex justify-content-center mt-5",children:(0,n.jsx)(s.Z,{onChange:(e,t)=>{o(t)},size:"large",page:t,count:r,color:"primary",renderItem:e=>(0,n.jsx)(a.Z,{sx:{color:"#B99755",":hover":{backgroundColor:"rgba(185, 151, 85, 0.20)"},"&.Mui-selected":{color:"#fff"}},components:{previous:_,next:h},...e})})})})}},36391:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var n=r(85893),s=r(22897),a=r.n(s),o=r(41664),i=r.n(o),c=r(11163);function d(e){let{tabItems:t=[]}=e,r=(0,c.useRouter)();return(0,n.jsx)("div",{className:a().userTabContainer,children:(0,n.jsx)("ul",{className:a().userTabSec,children:t.map((e,t)=>(0,n.jsx)("li",{className:r.asPath.includes(e.path)?a().active:"",children:(0,n.jsx)(i(),{href:e.path,children:(0,n.jsx)("span",{children:e.name})})},e.key))})})}},22535:function(e,t,r){"use strict";r.d(t,{Z:function(){return u}});var n=r(85893),s=r(11163),a=r(41664),o=r.n(a),i=r(98216),c=r.n(i),d=r(78773);function u(){let e=(0,s.useRouter)(),t=t=>t.some(t=>e.pathname.startsWith(t));return(0,n.jsx)("ul",{className:c().userTab,children:[{key:"profile",name:"會員資料",link:"/user/profile",paths:["/user/profile","/user/reset-password"]},{key:"reservation",name:"行程預約",link:"/user/reservation/ongoing",paths:["/user/reservation"]},{key:"orders",name:"商品訂單",link:"/user/orders/ongoing",paths:["/user/orders"]},{key:"favorite",name:"我的收藏",link:"/user/favorite",paths:["/user/favorite"]},{key:"coupons",name:"優惠券",link:"/user/coupon/ongoing",paths:["/user/coupon"]}].map((e,r)=>(0,n.jsx)("li",{className:t(e.paths)?c().active:"",children:(0,n.jsxs)(o(),{href:e.link,children:[(0,n.jsx)(d.ycZ,{}),(0,n.jsx)("span",{children:e.name})]})},e.key))})}},96345:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(85893);r(67294);var s=r(5024),a=r.n(s);function o(e){let{userTab:t,userTabSec:r,sectionRight:s}=e;return(0,n.jsx)("section",{className:a().sectionContainer,children:(0,n.jsxs)("div",{className:a().sectionBody,children:[t,(0,n.jsxs)("div",{className:a().sectionRight,children:[r,s]})]})})}},60077:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(85893),s=r(52891),a=r.n(s),o=r(35514),i=r(66641);function c(e){let{title:t="標題",btn1Hidden:r=!1,btn1Text:s="按鈕1",btn1Href:c=null,btn1OnClick:d,btn2Hidden:u=!1,btn2Text:l="按鈕2",btn2Href:_=null,btn2OnClick:h,btn3Hidden:p=!1,btn3Text:x="按鈕3",btn3Href:f=null,btn3OnClick:m}=e;return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:a().orderDetailHeader,children:[(0,n.jsx)("div",{className:a().headerLeft,children:(0,n.jsx)("p",{className:a().titleStyle,children:t})}),(0,n.jsxs)("div",{className:a().btnStack,children:[!p&&(0,n.jsx)(o.Z,{btnText:x,href:f,onClick:m}),!u&&(0,n.jsx)(o.Z,{btnText:l,href:_,onClick:h}),!r&&(0,n.jsx)(o.Z,{btnText:s,href:c,onClick:d})]})]}),(0,n.jsx)(i.Z,{margin:"1.5rem 0"})]})}},28829:function(e,t,r){"use strict";let n=(0,r(83886).Z)({palette:{primary:{main:"#B99755"},secondary:{main:"#A29415"},standard:{main:"#B99755"},grey:{main:"#5B5B5B",light:"#D9D9D9",dark:"#495057",contrastText:"rgba(255, 255, 255, 1)"},black:{main:"#222",light:"#D9D9D9",dark:"#343a40",contrastText:"rgba(255, 255, 255, 1)"},favRed:{main:"#BA0606",light:"#D9D9D9",dark:"#990101",contrastText:"#BA0606"}}});t.Z=n},33745:function(e,t,r){"use strict";var n=r(11163),s=r(87066),a=r(45747);t.Z=()=>{let e=(0,n.useRouter)();return{handleOrderCancel:async e=>{try{if((await s.Z.post("".concat(a.Qm,"?order_id=").concat(e))).data.success)return{success:!0};return{success:!1,error:"取消訂單失敗"}}catch(e){return console.error("取消訂單錯誤",e),{success:!1,error:"取消訂單錯誤"}}},handleOrderPayment:async(t,r)=>{try{let n=await s.Z.get(a.EJ,{params:{orderId:t,checkoutTotal:r}});n.data.success&&e.push({pathname:"/ecpay-checkout",query:{html:encodeURIComponent(n.data.html)}})}catch(e){console.error("提交表單時出錯",e)}},handleReservationPayment:async t=>{try{let r=await s.Z.get(a.hP,{params:{reservation_id:t}});r.data.success&&e.push({pathname:"/ecpay-checkout",query:{html:encodeURIComponent(r.data.html)}})}catch(e){console.error("提交表單時出錯",e)}},handleReservationCancel:async e=>{try{if((await s.Z.post("".concat(a.oj,"?reservation_id=").concat(e))).data.success)return{success:!0};return{success:!1,error:"取消預約失敗"}}catch(e){return console.error("取消預約錯誤",e),{success:!1,error:"取消預約錯誤"}}}}}},22326:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return M}});var n=r(85893),s=r(67294),a=r(11163),o=r(53483),i=r(96345),c=r(22535),d=r(36391),u=r(16410),l=r.n(u),_=r(27484),h=r.n(_),p=r(62325),x=r(16075),f=r(7820),m=r(97928),g=r(45747),y=()=>{let[e,t]=(0,s.useState)([]),[r,n]=(0,s.useState)([]),[a,o]=(0,s.useState)(1);return{allOrderData:e,allOrderDetails:r,totalPages:a,fetchAllOrders:async(e,r,s,a,i,c)=>{try{let d=await fetch("".concat(g.Pb,"?member_id=").concat(e,"&status=").concat(r,"&page=").concat(s,"&product_name=").concat(a,"&start_date=").concat(i,"&end_date=").concat(c));if(!d.ok)throw Error("Failed to fetch order data");let u=await d.json();console.log(u),t(u.orders),n(u.orderDetails),o(u.totalPages)}catch(e){console.log("Error fetching orders:",e)}}}},j=r(33745),b=r(57544),v=r(17681),k=r.n(v),S=r(60077),Z=r(16497),B=r.n(Z),C=r(85340);function N(e){let{icon:t=C.UzH,content:r=""}=e;return(0,n.jsxs)("div",{className:B().orderInfoRow,children:[(0,n.jsx)(t,{className:B().iconStyle}),(0,n.jsx)("p",{children:r})]})}var T=r(20027),w=r.n(T);function D(e){let{statusText:t}=e,r="";switch(t){case"待付款":default:r=w().orderStatusOrange;break;case"待出貨":r=w().orderStatusBlue;break;case"已完成":r=w().orderStatusGreen;break;case"已取消":r=w().orderStatusGrey}return(0,n.jsx)("div",{className:"".concat(w().orderStatusTag," ").concat(r),children:t})}var R=r(21173),I=r(2711),P=r.n(I);function L(e){let{order_id:t,merchant_trade_no:r,order_date:o,total_price:i,payment_type:c,full_address:d,status:u,orderDetailData:l,handlePayment:_,handleCancel:h,index:p}=e,x=(0,a.useRouter)();return(0,s.useEffect)(()=>{P().init()},[]),(0,n.jsxs)("div",{className:k().orderBox,"data-aos":"fade-right","data-aos-delay":p%2==0?0:200,children:[(0,n.jsx)(S.Z,{title:o,btn1Text:"詳情",btn1OnClick:()=>{x.push("/user/orders/details/".concat(t))},btn2Hidden:"ongoing"!==u,btn2Text:"重新付款",btn2OnClick:_,btn3Hidden:"ongoing"!==u&&"shipping"!==u,btn3Text:"取消訂單",btn3OnClick:h}),(0,n.jsxs)("div",{className:k().orderBody,children:[(0,n.jsxs)("div",{className:k().orderInfoRowBox,children:[(0,n.jsx)(N,{content:r}),(0,n.jsx)(N,{content:"".concat((0,b.T4)(i)," / ").concat("canceled"===u?"已取消":c),icon:C.sIe}),(0,n.jsx)(N,{content:d,icon:C.sin}),(0,n.jsx)(D,{statusText:(()=>{switch(u){case"ongoing":return"待付款";case"shipping":return"待出貨";case"completed":return"已完成";case"canceled":return"已取消"}})()})]}),(0,n.jsx)("div",{className:k().imgListBox,children:l.filter(e=>e.order_id===t).map((e,t)=>(0,n.jsx)(R.Z,{imgSrc:e.product_img?"".concat(g.DI,"/").concat(e.product_img):"",productId:e.product_id},t))})]})]})}r(73969);var E=r(54677),O=r(43036),H=r(59002),Y=r(36452),q=r(48043),A=r(35514);function G(e){let{status:t,initialPage:r=1}=e,[o,i]=(0,s.useState)(r),c=(0,a.useRouter)(),{auth:d,authIsReady:u}=(0,x.aC)(),{loginFormSwitch:_}=(0,p.NK)(),[g,v]=(0,s.useState)(!1),[k,S]=(0,s.useState)(!1),{allOrderData:Z,allOrderDetails:B,totalPages:C,fetchAllOrders:N}=y(),{handleOrderCancel:T,handleOrderPayment:w}=(0,j.Z)(),{openConfirmDialog:D}=(0,f.W)(),{openSnackbar:R}=(0,m.Ds)(),[I,P]=(0,s.useState)(""),[G,M]=(0,s.useState)(""),[Q,F]=(0,s.useState)(""),[J,z]=(0,s.useState)(""),K=h()(),U=K.subtract(1,"month").startOf("month").format("YYYY-MM-DD"),W=K.endOf("month").format("YYYY-MM-DD"),V=(e,r)=>{if("ongoing"===t)return async()=>{P("確定要取消訂單編號 ".concat(r," 嗎？")),D(async()=>{(await T(e)).success?R("已取消訂單","success"):R("取消訂單失敗","error"),S(!0)})}},X=(e,t,r)=>{if("待付款"===t)return()=>{w(e,r),S(!0)}};return(0,s.useEffect)(()=>{F(U),z(W)},[]),(0,s.useEffect)(()=>{c.isReady&&u&&(d.id?(v(!0),N(d.id,t,o,G,Q,J)):(v(!1),_("Login")))},[d.id,c.isReady,u,t,o]),(0,s.useEffect)(()=>{k&&d.id&&(N(d.id,t,o,G,Q,J),S(!1))},[k,d.id]),(0,s.useEffect)(()=>{i(1),M(""),F(U),z(W),N(d.id,t,1,"",U,W)},[t]),(0,n.jsxs)(n.Fragment,{children:[!g&&(0,n.jsx)(Y.Z,{}),(0,n.jsxs)("div",{className:l().searchContainer,children:[(0,n.jsxs)("div",{className:l().dateBox,children:[(0,n.jsx)("input",{type:"date",value:Q,onChange:e=>F(e.target.value),className:l().datePicker}),(0,n.jsx)("input",{type:"date",value:J,onChange:e=>z(e.target.value),className:l().datePicker})]}),(0,n.jsx)(q.Z,{placeholder:"請輸入商品名稱",inputStyles:"line",value:G,onChange:e=>M(e.target.value)}),(0,n.jsxs)("div",{className:l().btnStack,children:[(0,n.jsx)(A.Z,{btnText:"搜尋",href:null,onClick:()=>{i(1),N(d.id,t,1,G,Q,J)}}),(0,n.jsx)(A.Z,{btnText:"清空",href:null,onClick:()=>{M(""),F(U),z(W),N(d.id,t,1,"",U,W)}})]})]}),g&&0===Z.length?(0,n.jsx)("div",{className:l().orderBox,children:(0,n.jsx)(O.Z,{text:"無訂單記錄",backgroundColor:"transparent",borderRadius:"0rem"})}):Z.map((e,r)=>(0,n.jsx)(L,{index:r,order_id:e.order_id,merchant_trade_no:e.merchant_trade_no,order_date:(0,b.p6)(e.order_date),total_price:e.subtotal_price-e.discountTotal+e.deliver_fee,payment_type:e.payment_type,full_address:e.full_address,status:t,orderDetailData:B,member_id:d.id,page:o,handleCancel:V(e.order_id,e.merchant_trade_no),handlePayment:X(e.order_id,e.payment_type,e.total_price)},e.order_id)),g&&Z.length>0&&(0,n.jsx)(H.Z,{page:o,totalPages:C,onPageChange:e=>{i(e),N(d.id,t,e,G,Q,J)}}),(0,n.jsx)(E.Z,{dialogTitle:I,btnTextRight:"確定取消",btnTextLeft:"取消"})]})}function M(){let{status:e,page:t=1}=(0,a.useRouter)().query;return(0,n.jsx)(o.Z,{title:"商品訂單",pageName:"user",background:"light",children:(0,n.jsx)(i.Z,{userTab:(0,n.jsx)(c.Z,{}),userTabSec:(0,n.jsx)(d.Z,{tabItems:[{key:"ongoing",name:"待付款",path:"/user/orders/ongoing"},{key:"shipping",name:"待出貨",path:"/user/orders/shipping"},{key:"completed",name:"已完成",path:"/user/orders/completed"},{key:"canceled",name:"已取消",path:"/user/orders/canceled"}]}),sectionRight:(0,n.jsx)(G,{status:e,initialPage:parseInt(t)})})})}},61990:function(e){e.exports={inputDefault:"input01_inputDefault__rC9_w",inputDefaultLine:"input01_inputDefaultLine__A5JCq",inputDisabled:"input01_inputDisabled__lYkq_",inputDisabledLine:"input01_inputDisabledLine__4myS3",input:"input01_input__IyFIT",eyeIcon:"input01_eyeIcon__MsDLy"}},94525:function(e){e.exports={container:"redirect-guide_container__9fNVP",ghostImg:"redirect-guide_ghostImg__IwOg5"}},22897:function(e){e.exports={userTabSec:"user-tab-sec_userTabSec__QGfj_",active:"user-tab-sec_active__CTmZ6",userTabContainer:"user-tab-sec_userTabContainer__nkeKY"}},98216:function(e){e.exports={userTab:"user-tab_userTab__oitHd",active:"user-tab_active__WQZR9"}},5024:function(e){e.exports={sectionContainer:"user-layout_sectionContainer__ZrxdZ",sectionBody:"user-layout_sectionBody__cHqmz",sectionRight:"user-layout_sectionRight__pqtpQ"}},52891:function(e){e.exports={orderDetailHeader:"card-header_orderDetailHeader__PSFjR",headerLeft:"card-header_headerLeft__jyoUL",titleStyle:"card-header_titleStyle__4p5OE",btnStack:"card-header_btnStack___Dj_r"}},16497:function(e){e.exports={orderInfoRow:"icon-text-row_orderInfoRow__ALPlz",iconStyle:"icon-text-row_iconStyle__QFPTV"}},17681:function(e){e.exports={orderBox:"order-list-card_orderBox__AXfQU",orderBody:"order-list-card_orderBody__jtDEQ",orderInfoRowBox:"order-list-card_orderInfoRowBox__DYSnH",imgListBox:"order-list-card_imgListBox__sscmm"}},16410:function(e){e.exports={orderBox:"order-list-layout_orderBox__K0inB",orderBody:"order-list-layout_orderBody__jTpOC",orderInfoRowBox:"order-list-layout_orderInfoRowBox__BA0cz",imgListBox:"order-list-layout_imgListBox__H7tPm",searchContainer:"order-list-layout_searchContainer__qx97_",btnStack:"order-list-layout_btnStack__JJuYb",dateBox:"order-list-layout_dateBox__6VE8K",datePicker:"order-list-layout_datePicker___Vp7M"}},20027:function(e){e.exports={orderStatusTag:"order-status-tag_orderStatusTag__qwsAj",orderStatusOrange:"order-status-tag_orderStatusOrange__0jGsl",orderStatusGreen:"order-status-tag_orderStatusGreen__MIbS_",orderStatusBlue:"order-status-tag_orderStatusBlue__4syoJ",orderStatusGrey:"order-status-tag_orderStatusGrey__ClJOg"}}},function(e){e.O(0,[5970,4838,9317,4396,6660,509,2961,4321,959,6497,3223,936,9339,3483,2888,9774,179],function(){return e(e.s=89861)}),_N_E=e.O()}]);