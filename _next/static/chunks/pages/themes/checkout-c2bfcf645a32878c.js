(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5693],{433:function(e,t,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/themes/checkout",function(){return c(8829)}])},36452:function(e,t,c){"use strict";c.d(t,{Z:function(){return h}});var n=c(85893),s=c(94525),r=c.n(s),a=c(67294),o=c(11163),i=c(16075),u=c(62325),l=c(61435);function h(e){let{text:t="請先登入",btnText:c="登入",href:s=null,hideBtn:h=!1}=e,d=(0,o.useRouter)(),{auth:_,authIsReady:m}=(0,i.aC)(),{loginFormSwitch:p}=(0,u.NK)();return(0,a.useEffect)(()=>{d.isReady&&m&&!_.id&&p("Login")},[_.id,d.isReady,m]),(0,n.jsxs)("div",{className:r().container,children:[(0,n.jsx)("h6",{children:t}),(0,n.jsx)("img",{src:"/ghost/ghost_06.png",alt:"",className:r().ghostImg}),!h&&(0,n.jsx)(l.Z,{btnText:c,href:s,paddingType:"medium",onClick:()=>{p("Login")}})]})}},33745:function(e,t,c){"use strict";var n=c(11163),s=c(87066),r=c(45747);t.Z=()=>{let e=(0,n.useRouter)();return{handleOrderCancel:async e=>{try{if((await s.Z.post("".concat(r.Qm,"?order_id=").concat(e))).data.success)return{success:!0};return{success:!1,error:"取消訂單失敗"}}catch(e){return console.error("取消訂單錯誤",e),{success:!1,error:"取消訂單錯誤"}}},handleOrderPayment:async(t,c)=>{try{let n=await s.Z.get(r.EJ,{params:{orderId:t,checkoutTotal:c}});n.data.success&&e.push({pathname:"/ecpay-checkout",query:{html:encodeURIComponent(n.data.html)}})}catch(e){console.error("提交表單時出錯",e)}},handleReservationPayment:async t=>{try{let c=await s.Z.get(r.hP,{params:{reservation_id:t}});c.data.success&&e.push({pathname:"/ecpay-checkout",query:{html:encodeURIComponent(c.data.html)}})}catch(e){console.error("提交表單時出錯",e)}},handleReservationCancel:async e=>{try{if((await s.Z.post("".concat(r.oj,"?reservation_id=").concat(e))).data.success)return{success:!0};return{success:!1,error:"取消預約失敗"}}catch(e){return console.error("取消預約錯誤",e),{success:!1,error:"取消預約錯誤"}}}}}},3046:function(e,t,c){"use strict";var n=c(67294),s=c(11163);t.Z=()=>{let e=(0,s.useRouter)(),[t,c]=(0,n.useState)(0);return(0,n.useEffect)(()=>{c(document.body.clientWidth);let e=()=>{c(document.body.clientWidth)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[e.isReady]),t}},8829:function(e,t,c){"use strict";c.r(t),c.d(t,{default:function(){return N}});var n=c(85893),s=c(67294),r=c(53483),a=c(23690),o=c.n(a),i=c(11163),u=c(16075),l=c(62325),h=c(3046),d=c(33745),_=c(61435),m=c(30023),p=c.n(m),g=c(2472),x=c.n(g),f=c(57544);function j(e){let{label:t="label",content:c=0}=e;return(0,n.jsxs)("div",{className:x().totalRow,children:[(0,n.jsx)("p",{children:t}),(0,n.jsx)("p",{children:(0,f.T4)(c)})]})}var y=c(66641);function k(e){let{subtotal:t,checkoutTotal:c,totalDiscount:s}=e;return(0,n.jsxs)("div",{className:p().totalBox,children:[(0,n.jsx)(j,{label:"訂金",content:t}),(0,n.jsx)(y.Z,{margin:"0.75rem 0"}),(0,n.jsx)(j,{label:"總計",content:c})]})}var v=c(36452);function C(){let e=(0,i.useRouter)(),{auth:t,authIsReady:c}=(0,u.aC)(),{loginFormSwitch:r}=(0,l.NK)(),a=(0,h.Z)(),[m,p]=(0,s.useState)(a),{handleReservationPayment:g}=(0,d.Z)(),{name:x,mobile_phone:f,reservation_date:j,session_id:y,sessionTime:C,participants:N,discount:R,deposit:w,themeName:b,branchName:Z,themeImage:L,remark:E,reservation_id:I}=e.query,T=parseFloat(w)||0,S=async()=>{await g(I,w)};return((0,s.useEffect)(()=>{p(a)},[a]),(0,s.useEffect)(()=>{e.isReady&&c&&!t.id&&r("Login")},[t.id,e.isReady,c]),!t.id&&c)?(0,n.jsx)(v.Z,{}):(0,n.jsxs)("section",{className:o().sectionContainer,children:[(0,n.jsx)("h2",{className:o().h2Style,children:"確認預約"}),(0,n.jsxs)("div",{className:o().contentContainer,children:[(0,n.jsxs)("div",{className:o().checkoutLeft,children:[(0,n.jsx)("h5",{children:"預約資訊"}),(0,n.jsxs)("div",{className:o().itemList,children:[(0,n.jsxs)("p",{children:["主題: ",b," - ",Z]}),(0,n.jsxs)("p",{children:["姓名: ",x]}),(0,n.jsxs)("p",{children:["電話: ",f]}),(0,n.jsxs)("p",{children:["日期: ",j]}),(0,n.jsxs)("p",{children:["時間: ",C]}),(0,n.jsxs)("p",{children:["人數: ",N," 人"]}),R&&(0,n.jsxs)("p",{children:["優惠項目: ",R]}),E&&(0,n.jsxs)("p",{children:["備註: ",E]})]})]}),(0,n.jsxs)("div",{className:o().checkoutRight,children:[(0,n.jsx)("div",{className:o().themeImageContainer,style:{background:' url("/themes-main/'.concat(L,'") no-repeat center center / cover')}}),(0,n.jsx)(k,{subtotal:T,checkoutTotal:T,discountName:R}),(0,n.jsx)(_.Z,{btnText:"前往付款",href:null,paddingType:"medium",className:o().btnStyle,onClick:S})]})]})]})}function N(){return(0,n.jsx)(r.Z,{title:"結帳",background:"light",children:(0,n.jsx)(C,{})})}},94525:function(e){e.exports={container:"redirect-guide_container__9fNVP",ghostImg:"redirect-guide_ghostImg__IwOg5"}},30023:function(e){e.exports={totalBox:"checkout-total-table_totalBox__ovMZ7"}},23690:function(e){e.exports={h2Style:"checkout-page_h2Style__cgCg2",sectionContainer:"checkout-page_sectionContainer__1_YU9",contentContainer:"checkout-page_contentContainer___rgoL",checkoutLeft:"checkout-page_checkoutLeft__zVUtA",checkoutRight:"checkout-page_checkoutRight__YIGhW",itemList:"checkout-page_itemList__21pj_",btnStyle:"checkout-page_btnStyle__l__9Q",checkoutRightMain:"checkout-page_checkoutRightMain__quyAc",themeImageContainer:"checkout-page_themeImageContainer__t6oaH"}},2472:function(e){e.exports={totalRow:"checkout-total-row_totalRow__4GfCL"}}},function(e){e.O(0,[5970,4838,9317,4396,6660,509,2961,4321,959,6497,3483,2888,9774,179],function(){return e(e.s=433)}),_N_E=e.O()}]);