(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[864],{15929:function(e,t,s){"use strict";s.d(t,{Z:function(){return d}});var a=s(85893),c=s(67294),n=s(51172),i=s(77574),r=s(41664),o=s.n(r),l=s(47782),m=s(71055),g=s.n(m),u=s(11163);function d(e){let{productName:t="商品名稱"}=e,s=(0,u.useRouter)(),[r,m]=(0,c.useState)("");(0,c.useEffect)(()=>{t&&m(t)},[t]);let d=[(0,a.jsx)(i.Z,{className:g().font,underline:"hover",color:"#000",component:o(),href:"/",children:"首頁"},"1"),(0,a.jsx)(i.Z,{className:g().font,underline:"hover",color:"#000",component:o(),href:"/product",children:"商品列表"},"2"),(0,a.jsx)(i.Z,{className:g().font,underline:"none",color:"#000",children:r},"3")];return s.asPath.split("/").length<4&&d.pop(),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(n.Z,{className:g().bread,separator:(0,a.jsx)(l.Z,{htmlColor:"rgba(91, 91, 91, 1)",fontSize:"small"}),"aria-label":"breadcrumb",children:d})})}},69074:function(e,t,s){"use strict";s.d(t,{Z:function(){return j}});var a=s(85893),c=s(67294),n=s(45747),i=s(11163),r=s(62599),o=s(16075),l=s(72459),m=s.n(l),g=s(11828),u=s(19006),d=s(49367);s(48059);var _=s(84295),h=s(5152),f=s.n(h);function p(e){let{sendSticker:t}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:m().stickerWindow,children:(0,a.jsxs)("div",{className:m().stickerImgArea,children:[(0,a.jsx)("button",{onClick:()=>t(1),children:(0,a.jsx)("img",{className:m().stickerImg,src:"/sticker/ghost_1.png",alt:""})}),(0,a.jsx)("button",{onClick:()=>t(2),children:(0,a.jsx)("img",{className:m().stickerImg,src:"/sticker/ghost_2.png",alt:""})}),(0,a.jsx)("button",{onClick:()=>t(3),children:(0,a.jsx)("img",{className:m().stickerImg,src:"/sticker/ghost_3.png",alt:""})}),(0,a.jsx)("button",{onClick:()=>t(4),children:(0,a.jsx)("img",{className:m().stickerImg,src:"/sticker/ghost_4.png",alt:""})}),(0,a.jsx)("button",{onClick:()=>t(5),children:(0,a.jsx)("img",{className:m().stickerImg,src:"/sticker/ghost_5.png",alt:""})}),(0,a.jsx)("button",{onClick:()=>t(6),children:(0,a.jsx)("img",{className:m().stickerImg,src:"/sticker/ghost_6.png",alt:""})}),(0,a.jsx)("button",{onClick:()=>t(7),children:(0,a.jsx)("img",{className:m().stickerImg,src:"/sticker/ghost_7.png",alt:""})}),(0,a.jsx)("button",{onClick:()=>t(8),children:(0,a.jsx)("img",{className:m().stickerImg,src:"/sticker/ghost_8.png",alt:""})}),(0,a.jsx)("button",{onClick:()=>t(9),children:(0,a.jsx)("img",{className:m().stickerImg,src:"/sticker/ghost_9.png",alt:""})})]})})})}let x=(0,r.io)("http://localhost:4040");function j(){(0,i.useRouter)();let[e,t]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let e=()=>{window.scrollY<100?t(!1):t(!0)};return window.addEventListener("scroll",e),()=>{window.removeEventListener("scroll",e)}},[]);let r=f()(()=>Promise.all([s.e(8307),s.e(2016)]).then(s.bind(s,63048)),{loadableGenerated:{webpack:()=>[63048]},ssr:!1}),[l,h]=(0,c.useState)(!1),[j,k]=(0,c.useState)(null),[b,v]=(0,c.useState)(!1),[w,I]=(0,c.useState)(null),[N,y]=(0,c.useState)(""),[S,C]=(0,c.useState)(null),A=(0,c.useRef)(null),[R,D]=(0,c.useState)(!1),[E,P]=(0,c.useState)(""),[Z,B]=(0,c.useState)("text"),[L,W]=(0,c.useState)(""),[F,T]=(0,c.useState)([]),[q,U]=(0,c.useState)(""),{auth:J,authIsReady:z}=(0,o.aC)();(0,c.useEffect)(()=>{let e="room_".concat(J.id);"room_0"!==e&&(P(J.nickname),U(e),x.emit("joinRoom",{room:e,username:J.nickname}))},[z,J]),(0,c.useEffect)(()=>(x.on("chat message",e=>{let{room:t,username:s,type:a,message:c}=e;T(e=>[...e,{room:t,username:s,type:a,message:c}])}),x.on("history",e=>{T(e)}),x.on("disconnect",()=>{}),()=>{x.off("chat message"),x.off("history"),x.off("joinRoom")}),[]);let G=async()=>{if(S){let e=new FormData;e.append("file",S);try{let t=await fetch("http://localhost:3001/products/upload",{method:"POST",body:e,enctype:"multipart/form-data"}),s=await t.json();y(s.filePath),B("img")}catch(e){console.log(e)}}};(0,c.useEffect)(()=>{G()},[S]);let M=(0,c.useRef)(null),Y=()=>{var e;null===(e=M.current)||void 0===e||e.scrollIntoView({block:"end",inline:"nearest"})};(0,c.useEffect)(()=>{Y()},[F,N,R]),(0,c.useEffect)(()=>{M.current&&Y()},[M.current]),(0,c.useEffect)(()=>{let e=document.querySelector(".".concat(m().msgtext));if(e){let t=new ResizeObserver(()=>{Y()});return t.observe(e),()=>t.disconnect()}},[]);let H=()=>{D(!R)},V=(0,c.useCallback)(e=>{W(t=>t+e.emoji)},[]),O=(0,c.useMemo)(()=>(0,a.jsx)(r,{autoFocusSearch:!1,previewConfig:{showPreview:!1},skinTonesDisabled:!0,onEmojiClick:V,data:j}),[V,j]);return(0,c.useEffect)(()=>{(async()=>{try{let e=await s.e(4861).then(s.bind(s,14861));k(e)}catch(e){console.error("Failed to preload emoji data:",e)}})()},[]),R?(0,a.jsxs)("div",{className:"".concat(m().fix," animate__animated animate__fadeInUp animate__faster"),children:[(0,a.jsxs)("div",{className:m().top,children:[(0,a.jsx)("button",{className:m().topArrow,onClick:H,children:(0,a.jsx)(g.u1R,{})}),(0,a.jsx)("h5",{children:"悄瞧"})]}),(0,a.jsx)("div",{id:m().messageArea,children:(0,a.jsx)("div",{className:m().msgtext,ref:M,children:F.length<1?(0,a.jsxs)("div",{className:"".concat(m().right),children:[(0,a.jsx)("img",{id:m().adminImg,src:"/ghost/ghost_15.png",alt:""}),(0,a.jsx)("p",{className:m().msgRight,children:"您好!請問需要什麼服務呢?"})]}):F.map((e,t)=>"管理員"===e.username?(0,a.jsxs)("div",{className:"".concat(m().right),children:[(0,a.jsx)("img",{id:m().adminImg,src:"/ghost/ghost_15.png",alt:""}),(0,a.jsx)("p",{className:m().msgRight,children:e.message},t)]},t):"text"===e.type?(0,a.jsx)("div",{className:"".concat(m().left),children:(0,a.jsx)("p",{className:m().msgLeft,children:e.message},t)},t):"img"===e.type?(0,a.jsx)("div",{className:"".concat(m().left),children:(0,a.jsx)("img",{className:m().msgLeftImg,src:"".concat(n.UW,"/img/").concat(e.message),alt:"img"},t)},t):"sticker"===e.type?(0,a.jsx)("div",{className:"".concat(m().left),children:(0,a.jsx)("img",{className:m().msgLeftSticker,src:"/sticker/ghost_".concat(e.message,".png"),alt:"img"},t)},t):void 0)})}),(0,a.jsx)("div",{className:m().bottom,children:(0,a.jsxs)("form",{id:m().form,className:m().input,onSubmit:e=>{if(e.preventDefault(),L)x.emit("chat message",{room:q,username:E,type:Z,message:L}),W("");else if(N)x.emit("chat message",{room:q,username:E,type:Z,message:N}),B("text"),y("");else if(""===L)return},children:[(0,a.jsxs)("div",{className:m().emojiArea,children:[(0,a.jsx)("button",{onClick:()=>{h(!l)},type:"button",children:(0,a.jsx)(_.dG6,{style:{width:"26px",height:"26px"}})}),l&&j&&(0,a.jsx)("div",{className:m().emojiPicker,children:O})]}),(0,a.jsxs)("div",{className:m().stickersArea,children:[(0,a.jsx)("button",{onClick:()=>{v(!b)},type:"button",children:(0,a.jsx)(_.Pb0,{style:{width:"26px",height:"26px"}})}),b&&(0,a.jsx)(p,{sendSticker:e=>{x.emit("chat message",{room:q,username:E,type:"sticker",message:e})}})]}),(0,a.jsxs)("div",{className:m().uploadImgArea,children:[(0,a.jsx)("button",{onClick:()=>{A.current&&A.current.click()},type:"button",children:(0,a.jsx)(_.jLr,{style:{width:"26px",height:"26px"}})}),(0,a.jsx)("div",{id:m().originalInput,children:(0,a.jsx)("input",{type:"file",id:"myImage",name:"myImage",ref:A,onChange:e=>{C(e.target.files[0])}})}),N&&(0,a.jsx)("div",{className:m().uploadWindow,children:(0,a.jsx)("img",{src:"".concat(n.UW,"/img/").concat(N),alt:"img"})})]}),(0,a.jsx)("input",{className:m().messageInp,type:"text",value:L,onChange:e=>W(e.target.value)}),(0,a.jsx)("button",{type:"submit",children:(0,a.jsx)(u.JF1,{})})]})})]}):(0,a.jsx)("div",{className:"".concat(e?"":m().visible),children:(0,a.jsx)("button",{className:"".concat(m().openButton," animate__animated animate__fadeInDown animate__faster"),onClick:H,children:(0,a.jsx)(d.Zs0,{})})})}},62563:function(e,t,s){"use strict";s.d(t,{G:function(){return g},i:function(){return m}});var a=s(85893),c=s(67294),n=s(11163),i=s(45747),r=s(97928),o=s(16075);let l=(0,c.createContext)();function m(){return(0,c.useContext)(l)}let g=e=>{let{children:t}=e,s=(0,n.useRouter)(),{auth:m,authIsReady:g}=(0,o.aC)(),{openSnackbar:u}=(0,r.Ds)(),[d,_]=(0,c.useState)(!0),[h,f]=(0,c.useState)(1),[p,x]=(0,c.useState)({success:!1,page:0,totalRows:0,totalPages:0,rows:[]}),[j,k]=(0,c.useState)({success:!1,page:0,totalRows:0,totalPages:0,rows:[]}),[b,v]=(0,c.useState)(!1),[w,I]=(0,c.useState)(!1),[N,y]=(0,c.useState)(""),S=async(e,t)=>{e=e||1,t=t||1;let s="".concat(i.kD,"?page=").concat(e,"&user_id=").concat(t);try{let e=await fetch(s),t=await e.json();t.success?k(t):(k({success:!1,page:0,totalRows:0,totalPages:0,rows:[]}),console.log("getFavorite無資料"),console.log("favoriteData:",j))}catch(e){console.error(e)}},C=async(e,t,s,a,c,n,r)=>{e=e||1,t=t||"",s=s||"",a=a||"",c=c||"",n=n||"",r=r||"";let o="".concat(i.ZS,"?page=").concat(e,"&category_id=").concat(t,"&sort=").concat(s,"&order=").concat(a,"&userSearch=").concat(c,"&price_start=").concat(n,"&price_end=").concat(r);try{let e=await fetch(o),t=await e.json();t.success?x(t):u("無此商品","error")}catch(e){console.error(e)}};return(0,c.useEffect)(()=>{let{page:e,category_id:t,sort:a,order:c,userSearch:n,price_start:i,price_end:r}=s.query;if(s.isReady){let o=s.asPath.split("?");"/user/favorite"===o[0]?S(e,m.id):"/product"===o[0]&&C(e,t,a,c,n,i,r)}},[s.query,d,g]),(0,a.jsx)(l.Provider,{value:{getFavorite:S,getProductRows:C,data:p,router:s,buyQuantity:h,showIcon:b,userSearch:N,cardChange:d,showIconNew:w,favoriteData:j,setFavoriteData:k,setShowIconNew:I,setCardChange:_,setUserSearch:y,setShowIcon:v,setBuyQuantity:f},children:t})}},28829:function(e,t,s){"use strict";let a=(0,s(83886).Z)({palette:{primary:{main:"#B99755"},secondary:{main:"#A29415"},standard:{main:"#B99755"},grey:{main:"#5B5B5B",light:"#D9D9D9",dark:"#495057",contrastText:"rgba(255, 255, 255, 1)"},black:{main:"#222",light:"#D9D9D9",dark:"#343a40",contrastText:"rgba(255, 255, 255, 1)"},favRed:{main:"#BA0606",light:"#D9D9D9",dark:"#990101",contrastText:"#BA0606"}}});t.Z=a},72369:function(e,t,s){"use strict";s.d(t,{Y:function(){return n}});var a=s(67294),c=s(45747);s(71161);let n=e=>{let[t,s]=(0,a.useState)([]),n=async e=>{let t="".concat(c.lo,"/").concat(e),a=[];try{let e=await fetch(t),c=await e.json();c.success&&(c.rows.map(e=>{a.push(e.product_img)}),s(a))}catch(e){console.error(e)}};return(0,a.useEffect)(()=>{e&&n(e)},[e]),{data:t}}},71055:function(e){e.exports={font:"bread_font__V_vED",bread:"bread_bread__9hJR7"}},72459:function(e){e.exports={fix:"message_fix__3sd0G",openButton:"message_openButton__f6ldp",top:"message_top__JQ5fR",topArrow:"message_topArrow__In_iA",messageArea:"message_messageArea__FxkKf",msgtext:"message_msgtext__WhZ6t",form:"message_form___9DBS",bottom:"message_bottom__DiZci",visible:"message_visible__6LUBs",right:"message_right__PnMuw",left:"message_left__ITk4S",msgLeft:"message_msgLeft__t0ICm",msgRight:"message_msgRight__7Usqr",msgLeftImg:"message_msgLeftImg__6E5Za",msgLeftSticker:"message_msgLeftSticker__JW_Hf",adminImg:"message_adminImg__EMXTW",emojiArea:"message_emojiArea__fAYPy",stickersArea:"message_stickersArea__3Rcpy",uploadImgArea:"message_uploadImgArea__1XzD0",emojiPicker:"message_emojiPicker__ohBqP",stickerWindow:"message_stickerWindow__bpJI5",stickerImgArea:"message_stickerImgArea__v_PSU",stickerImg:"message_stickerImg__6MY2H",originalInput:"message_originalInput__6Vz9x",uploadWindow:"message_uploadWindow__qrdQH",sendImg:"message_sendImg__Z9_fA",messageInp:"message_messageInp__SE4nC"}}}]);